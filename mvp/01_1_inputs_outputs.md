# Входы и Выходы системы (Inputs & Outputs) MVP v1.1

Этот документ описывает все точки взаимодействия пользователей с системой: какие данные мы получаем (Inputs) и какие данные/интерфейсы отдаем (Outputs).

---

## 1. Клиент (Заказчик)

### 1.1 Процесс: Первичный вход и Подача заявки
*Клиент сканирует QR-код и попадает в WhatsApp.*

*   **Вход (Input) - WhatsApp:**
    *   `Phone Number` (Автоматически от WhatsApp).
    *   `Message Body` (Текст проблемы или Аудио).
    *   `Media` (Фото/Видео проблемы).
*   **Выход (Output) - WhatsApp:**
    *   `Приветствие`: "Здравствуйте! Заявку принял. Опишите проблему и пришлите фото." (Если первый контакт).

### 1.2 Процесс: Уточнение адреса (Новый пользователь)
*Бот запрашивает адрес, так как его нет в базе.*

*   **Вход (Input) - WhatsApp:**
    *   `Address Text` (Текст: "Ул. Ленина 1, кв 15").
    *   `Postal Code` (Текст: "30966" - Желательно).
    *   `Full Name` (Текст: "Иван Иванов").
*   **Выход (Output) - WhatsApp:**
    *   `Запрос`: "Для завершения напишите адрес и индекс (PLZ). Например: Hauptstr. 1, 30966."

### 1.3 Процесс: Выбор адреса (Существующий пользователь)
*У пользователя уже есть адреса в `user_addresses`.*

*   **Выход (Output) - WhatsApp:**
    *   `Вопрос`: "Вызвать мастера на адрес: Hauptstr. 1 (Дом)?"
    *   `Кнопки`: `[Да, сюда]`, `[Нет, другой]`.
*   **Вход (Input) - WhatsApp:**
    *   `Selection`: Нажатие кнопки. Если "Другой" -> переходим к шагу 1.2 (Ввод нового).

### 1.4 Процесс: Закрытие заявки
*Работа выполнена.*

*   **Вход (Input) - WhatsApp:**
    *   `Rating` (1-5).
*   **Выход (Output) - WhatsApp:**
    *   `Отчет`: Фото результата.
    *   `Запрос оценки`: "Оцените работу от 1 до 5."

---

## 2. Мастер (Исполнитель)

### 2.1 Процесс: Регистрация Мастера
*Строгая регистрация через Веб-форму.*

*   **Вход (Input) - Web Form:**
    *   `Full Name` (ФИО).
    *   `Phone Number` (WhatsApp ID).
    *   `Role Type` (Worker / Company).
    *   `Service Area ZIPs` (Список индексов: 30966, 30100...).
    *   `Documents` (Паспорт, Лицензия).
*   **Выход (Output) - WhatsApp:**
    *   `Статус`: "Ваша заявка на проверке."

### 2.2 Процесс: Получение работы
*Мастер получает уведомление.*

*   **Выход (Output) - WhatsApp:**
    *   `Карточка`: "Заявка #105. ZIP: 30966. Тип: Сантехника. [Фото]."
    *   `Кнопки`: `[Принять]`.
*   **Вход (Input) - WhatsApp:**
    *   `Action`: `[Принять]`.

### 2.3 Процесс: Выполнение
*   **Вход (Input) - Web View (Мои заказы):**
    *   `Status`: "Начал работу".
    *   `Result`: Фото результата.
    *   `Status`: "Завершил".

---

## 3. Диспетчер (Администратор)

### 3.1 Процесс: Мониторинг
*   **Вход (Input):**
    *   `Update Request`: Изменение описания/категории.
    *   `Cancel Request`.
*   **Выход (Output) - Dashboard:**
    *   `Active Requests View`: Список заявок со статусом `new`/`assigned`, сгруппированный по ZIP-кодам.

---

## 4. Сводная таблица полей (Data Dictionary) v1.1

| Сущность | Поле (Input) | Тип | Откуда | Обязательно? |
| :--- | :--- | :--- | :--- | :--- |
| **User** | Phone | String | WhatsApp | Yes |
| | Sub-role | Enum | System | Yes (default Tenant) |
| **Address** | Text | String | Chat | Yes |
| | Postal Code | String | Chat | Desirable |
| **Request** | Description | Text | Chat | Yes |
| | Postal Code | String | System (Copy) | Yes |
| **Media** | Bucket Path | String | System | Yes |
