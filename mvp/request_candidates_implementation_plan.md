# üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –∑–∞—è–≤–∫–∏ - AssetCare24 v2.5

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 26 —è–Ω–≤–∞—Ä—è 2026 –≥.
**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ workflow —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏
**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –∫–æ–¥ –≥–æ—Ç–æ–≤

---

## üìã –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –†–ï–®–ï–ù–ò–Ø

### üéØ **–ë–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å:**
```
1. –ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è ‚Üí published_at, telegram_message_id
2. –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ Telegram –∫–∞–Ω–∞–ª ‚Üí status: 'waiting_candidates'
3. –ú–∞—Å—Ç–µ—Ä–∞ –æ—Ç–∫–ª–∏–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ WhatsApp ‚Üí request_candidates records
4. –ê–¥–º–∏–Ω –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–µ–≥–æ ‚Üí status: 'master_assigned'
5. –î–∞–ª—å–Ω–µ–π—à–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª ‚Üí scheduled ‚Üí in_progress ‚Üí completed
```

### üèóÔ∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

#### **–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `request_candidates`**
```sql
CREATE TABLE request_candidates (
  id uuid PK,
  request_id bigint FK ‚Üí requests.id,
  master_id text FK ‚Üí masters.id,
  applied_at timestamptz,
  status: 'pending' | 'selected' | 'rejected' | 'withdrawn',
  master_comment text,
  admin_comment text,
  selected_at timestamptz,
  UNIQUE(request_id, master_id)
);
```

#### **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫:**
- `waiting_candidates` - –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞, –∂–¥–µ–º –æ—Ç–∫–ª–∏–∫–æ–≤
- `candidates_collecting` - —Å–æ–±–∏—Ä–∞–µ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- `master_selection` - –∞–¥–º–∏–Ω –≤—ã–±–∏—Ä–∞–µ—Ç –∏–∑ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- `master_assigned` - –º–∞—Å—Ç–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω
- `scheduled` - –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –¥–∞—Ç–∞
- `in_progress` - –≤ —Ä–∞–±–æ—Ç–µ
- `paused` - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `feedback_pending` - –∂–¥–µ–º –æ—Ü–µ–Ω–∫–∏
- `feedback_received` - –æ—Ü–µ–Ω–∫–∞ –ø–æ–ª—É—á–µ–Ω–∞
- `canceled` - –æ—Ç–º–µ–Ω–µ–Ω–∞

---

## üîÑ –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø

### **–≠—Ç–∞–ø 1: –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (30 –º–∏–Ω)**

#### **–§–∞–π–ª—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
1. `mvp/add_request_candidates_migration.sql`
2. `mvp/create_assign_master_function.sql`

#### **–ö–æ–º–∞–Ω–¥—ã:**
```bash
# –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É:
1. add_request_candidates_migration.sql
2. create_assign_master_function.sql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
SELECT 'Migration completed' as status,
       (SELECT COUNT(*) FROM request_candidates) as candidates_table,
       (SELECT COUNT(*) FROM requests WHERE status IN ('waiting_candidates', 'master_assigned')) as updated_requests;
```

#### **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `request_candidates` —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `requests` –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `assign_master_to_request` —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ View `view_dispatcher_dashboard` –æ–±–Ω–æ–≤–ª–µ–Ω

### **–≠—Ç–∞–ø 2: –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∞–¥–º–∏–Ω–∫–∏ (15 –º–∏–Ω)**

#### **–ö–æ–º–∞–Ω–¥—ã:**
```bash
cd /home/aaa/Projects/n8n/assetcare24/site
npm run dev
# –ò–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É –µ—Å–ª–∏ 3000 –∑–∞–Ω—è—Ç:
npm run dev -- --port 3001
```

#### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ `http://localhost:3001/dashboard/admin`
2. ‚úÖ –í —Ç–∞–± "Auftr√§ge" –≤–∏–¥–Ω—ã –∑–∞—è–≤–∫–∏
3. ‚úÖ –£ –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –æ–∂–∏–¥–∞–Ω–∏—è –≤–∏–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ "Kandidaten"
4. ‚úÖ –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ

### **–≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (45 –º–∏–Ω)**

#### **–¢–µ—Å—Ç-–∫–µ–π—Å—ã:**

##### **3.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:**
```
‚úÖ –ù–∞–π—Ç–∏ –∑–∞—è–≤–∫—É —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "offen"
‚úÖ –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Kandidaten"
‚úÖ –£–≤–∏–¥–µ—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Å—Ç–µ—Ä–∞—Ö
```

##### **3.2 –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞:**
```
‚úÖ –í –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –Ω–∞–∂–∞—Ç—å "Zuweisen" —É –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
‚úÖ –£–≤–∏–¥–µ—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ "zugewiesen"
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ rejected
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ë–î
```

##### **3.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –≤—Ä—É—á–Ω—É—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
```bash
# –ß–µ—Ä–µ–∑ API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
curl -X POST http://localhost:3001/api/admin/orders/101/candidates \
  -H "Content-Type: application/json" \
  -d '{"master_id": "mid_wa_49987654321", "master_comment": "–¢–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç"}'
```

### **–≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º (–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)**

#### **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ n8n workflow:**

##### **4.1 –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∑–∞—è–≤–∫–∏:**
```javascript
// –û–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫—É –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Telegram
UPDATE requests
SET status = 'waiting_candidates',
    published_at = NOW(),
    telegram_message_id = '${TELEGRAM_MESSAGE_ID}'
WHERE id = ${REQUEST_ID}
```

##### **4.2 –ü—Ä–∏ –æ—Ç–∫–ª–∏–∫–µ –º–∞—Å—Ç–µ—Ä–∞:**
```javascript
// –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
INSERT INTO request_candidates (request_id, master_id, master_comment)
VALUES (${REQUEST_ID}, '${MASTER_ID}', '${MASTER_COMMENT}')
ON CONFLICT (request_id, master_id) DO NOTHING

// –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
UPDATE requests
SET status = 'candidates_collecting'
WHERE id = ${REQUEST_ID}
  AND status = 'waiting_candidates'
```

##### **4.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ Telegram:**
```javascript
// –ü—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞ –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª–µ
// –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º –º–∞—Å—Ç–µ—Ä–µ
```

---

## üéõÔ∏è –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ô –ò–ù–¢–ï–†–§–ï–ô–°

### **–í–∫–ª–∞–¥–∫–∞ "Auftr√§ge" - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

#### **–°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üîß –ó–∞–º–µ–Ω–∞ —Ä–æ–∑–µ—Ç–∫–∏ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π                                    ‚îÇ
‚îÇ –ê–Ω–Ω–∞ –ú—é–ª–ª–µ—Ä ‚Ä¢ 23.01.2026 ‚Ä¢ [3 Kandidaten]                     ‚îÇ
‚îÇ [offen] [Kandidaten]                                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–º–µ—Å–∏—Ç–µ–ª—è                                        ‚îÇ
‚îÇ –ú–∞–∫—Å –®–º–∏–¥—Ç ‚Ä¢ 22.01.2026                                       ‚îÇ
‚îÇ [zugewiesen]                                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Kandidaten f√ºr Auftrag #101                                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üîß –ó–∞–º–µ–Ω–∞ —Ä–æ–∑–µ—Ç–∫–∏ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π, –∏—Å–∫—Ä–∏—Ç –∏ –≥—Ä–µ–µ—Ç—Å—è               ‚îÇ
‚îÇ –ê–Ω–Ω–∞ –ú—é–ª–ª–µ—Ä ‚Ä¢ Elektrik                                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üë∑ –ê–Ω–Ω–∞ –®–º–∏–¥—Ç (Elektrik)                                      ‚îÇ
‚îÇ üìû +49123456789 ‚Ä¢ ‚≠ê 4.5 ‚Ä¢ ‚úÖ 12 Auftr√§ge                     ‚îÇ
‚îÇ üí¨ "–ì–æ—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏"                  ‚îÇ
‚îÇ [Ausstehend] [Zuweisen]                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üë∑ –ú–∞–∫—Å –í–∞–≥–Ω–µ—Ä (Elektrik)                                     ‚îÇ
‚îÇ üìû +49987654321 ‚Ä¢ ‚≠ê 4.8 ‚Ä¢ ‚úÖ 25 Auftr√§ge                     ‚îÇ
‚îÇ [Ausgew√§hlt]                                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### **API Endpoints:**

#### **GET /api/admin/orders/[id]/candidates**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –∑–∞—è–≤–∫—É
- –í–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞—Å—Ç–µ—Ä–∞—Ö –∏ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

#### **POST /api/admin/orders/[id]/candidates**
- –î–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ—Ç–æ–º –¥–ª—è –æ—Ç–∫–ª–∏–∫–æ–≤ –º–∞—Å—Ç–µ—Ä–æ–≤

#### **POST /api/admin/orders/[id]/assign**
- –ù–∞–∑–Ω–∞—á–∞–µ—Ç –º–∞—Å—Ç–µ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- –í—ã–∑—ã–≤–∞–µ—Ç PostgreSQL —Ñ—É–Ω–∫—Ü–∏—é `assign_master_to_request`

### **Database Views:**

#### **view_dispatcher_dashboard** (–æ–±–Ω–æ–≤–ª–µ–Ω)
```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
SELECT r.*,
       COALESCE(rc.candidates_count, 0) as candidates_count
FROM requests r
LEFT JOIN (
  SELECT request_id, COUNT(*) as candidates_count
  FROM request_candidates
  GROUP BY request_id
) rc ON r.id = rc.request_id
```

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ Row Level Security –≤–∫–ª—é—á–µ–Ω–∞ –¥–ª—è `request_candidates`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –û–¢–ß–ï–¢–ù–û–°–¢–¨

### **–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**

#### **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:**
```sql
-- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
SELECT AVG(EXTRACT(EPOCH FROM (assigned_at - published_at))/3600) as avg_hours_to_assign
FROM requests
WHERE status IN ('master_assigned', 'scheduled', 'in_progress', 'completed');

-- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
SELECT
  COUNT(*) as total_candidates,
  COUNT(CASE WHEN status = 'selected' THEN 1 END) as selected_candidates,
  ROUND(
    COUNT(CASE WHEN status = 'selected' THEN 1 END)::decimal /
    NULLIF(COUNT(*), 0) * 100, 2
  ) as selection_rate_percent
FROM request_candidates;
```

#### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
```sql
-- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π
SELECT
  CASE
    WHEN master_settings->>'spec_elektrik' = 'true' THEN 'Elektrik'
    WHEN master_settings->>'spec_sanitaer' = 'true' THEN 'Sanit√§r'
    WHEN master_settings->>'spec_heizung' = 'true' THEN 'Heizung'
    WHEN master_settings->>'spec_maler' = 'true' THEN 'Maler'
    ELSE 'Sonstige'
  END as specialization,
  COUNT(*) as applications_count
FROM request_candidates rc
JOIN masters m ON rc.master_id = m.id
GROUP BY specialization
ORDER BY applications_count DESC;
```

---

## üö® –†–ò–°–ö–ò –ò –ü–†–û–ë–õ–ï–ú–´

### **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

#### **1. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:**
- **–†–∏—Å–∫:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤ –º–æ–≥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** PostgreSQL —Ñ—É–Ω–∫—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å

#### **2. –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã:**
- **–†–∏—Å–∫:** –ú–∞—Å—Ç–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª–∏–∫–∞
- **–†–µ—à–µ–Ω–∏–µ:** –°—Ç–∞—Ç—É—Å `withdrawn`, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

#### **3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–†–∏—Å–∫:** –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∑–∞–º–µ–¥–ª–∏—Ç UI
- **–†–µ—à–µ–Ω–∏–µ:** –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –∏–Ω–¥–µ–∫—Å—ã, –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

#### **4. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Telegram:**
- **–†–∏—Å–∫:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –∫–∞–Ω–∞–ª–µ –∏ –ë–î
- **–†–µ—à–µ–Ω–∏–µ:** Webhooks –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üéØ –ü–õ–ê–ù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

#### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞—è–≤–∫–∏**
```
1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É
2. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ Telegram (–∏–º–∏—Ç–∞—Ü–∏—è)
3. –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ API
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ
5. –ù–∞–∑–Ω–∞—á–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
7. –ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
```

#### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø**
```
1. –î–≤–∞ –∞–¥–º–∏–Ω–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
2. –û–¥–∏–Ω –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –º–∞—Å—Ç–µ—Ä–∞
3. –í—Ç–æ—Ä–æ–π –≤–∏–¥–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
```

#### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
```
1. –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
2. –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –∑–∞—è–≤–∫—É
3. –°–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```

---

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### **–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏:**
- ‚è±Ô∏è **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:** —Å 24—á ‚Üí 2-4—á
- üìà **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** –±–æ–ª—å—à–µ –º–∞—Å—Ç–µ—Ä–æ–≤ –Ω–∞ –∑–∞—è–≤–∫—É
- ‚≠ê **–ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞:** –≤—ã–±–æ—Ä –ª—É—á—à–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- üéØ **–£–ª—É—á—à–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:** –∫–ª–∏–µ–Ω—Ç—ã + –º–∞—Å—Ç–µ—Ä–∞

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:**
- ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** < 500ms API –æ—Ç–≤–µ—Ç—ã
- üîí **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 99.9% uptime
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ø–æ–ª–Ω–∞—è traceability –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–°–∏—Å—Ç–µ–º–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≥–æ—Ç–æ–≤–∞ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é!**

### **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. ‚úÖ **–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î**
2. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∞–¥–º–∏–Ω–∫—É**
3. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
4. üîÑ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram –±–æ—Ç–æ–º**
5. üìä **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**

### **–í—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:**
- **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:** 30 –º–∏–Ω—É—Ç
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** 45 –º–∏–Ω—É—Ç
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º:** 1-2 —á–∞—Å–∞
- **–ü–æ–ª–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:** 2-3 —á–∞—Å–∞

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞! üöÄ**
