# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã + –°–æ—Å—Ç–∞–≤–Ω—ã–µ ID

**–î–∞—Ç–∞:** 11 —è–Ω–≤–∞—Ä—è 2026 –≥.
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** AI Assistant

## üéØ –û–±–∑–æ—Ä

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö AssetCare24 —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –º–∞—Å—Ç–µ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –∏ –∫–∞–Ω–∞–ª–æ–≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.

## üèóÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π:** –ö–ª–∏–µ–Ω—Ç—ã –∏ –º–∞—Å—Ç–µ—Ä–∞ - —Ä–∞–∑–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏:** –û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –º–∞—Å—Ç–µ—Ä–æ–º
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã:** WhatsApp, Telegram, Web, Mobile App
- **–ì–∏–±–∫–æ—Å—Ç—å —Å–≤—è–∑–µ–π:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–≤—è–∑—ã–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ (–æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫, —Å–µ–º—å—è, –∫–æ–º–ø–∞–Ω–∏—è)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:** `clients` –∏ `masters` –≤–º–µ—Å—Ç–æ –µ–¥–∏–Ω–æ–π `users`
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ ID:** `{role}_{channel}_{identifier}` —Ñ–æ—Ä–º–∞—Ç
- **–¢–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–µ–π:** `user_links` –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π

---

## üÜî –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö ID

### –§–æ—Ä–º–∞—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
```
{role_prefix}_{channel_prefix}_{normalized_identifier}
```

### –ü—Ä–µ—Ñ–∏–∫—Å—ã —Ä–æ–ª–µ–π
- **cid_** = Client ID (–∫–ª–∏–µ–Ω—Ç)
- **mid_** = Master ID (–º–∞—Å—Ç–µ—Ä)
- **aid_** = Admin ID (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)

### –ü—Ä–µ—Ñ–∏–∫—Å—ã –∫–∞–Ω–∞–ª–æ–≤
- **wa_** = WhatsApp
- **tg_** = Telegram
- **web_** = Web (email/—Ñ–æ—Ä–º–∞)
- **app_** = Mobile App (device_id)

### –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
```javascript
function normalizeIdentifier(identifier) {
  // –¢–µ–ª–µ—Ñ–æ–Ω: —É–±–∏—Ä–∞–µ–º + –∏ –ø—Ä–æ–±–µ–ª—ã
  if (identifier.startsWith('+')) {
    return identifier.substring(1).replace(/\s/g, '');
  }

  // Email: –∑–∞–º–µ–Ω—è–µ–º @ –Ω–∞ _at_
  if (identifier.includes('@')) {
    return identifier.replace('@', '_at_').replace(/\./g, '_dot_');
  }

  // Telegram ID: –∫–∞–∫ –µ—Å—Ç—å (—á–∏—Å–ª–æ–≤–æ–π)
  if (/^\d+$/.test(identifier)) {
    return identifier;
  }

  // Device ID: –∫–∞–∫ –µ—Å—Ç—å
  return identifier.replace(/[^a-zA-Z0-9]/g, '_');
}
```

### –ü—Ä–∏–º–µ—Ä—ã ID
```
cid_wa_491510416555        # –ö–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ WhatsApp
mid_wa_491510416555        # –ú–∞—Å—Ç–µ—Ä —á–µ—Ä–µ–∑ WhatsApp (—Ç–æ—Ç –∂–µ —á–µ–ª–æ–≤–µ–∫!)
cid_tg_123456789           # –ö–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ Telegram
mid_web_user_at_email_dot_com  # –ú–∞—Å—Ç–µ—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –ø–æ email
cid_app_abc123def456       # –ö–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: clients
```sql
CREATE TABLE clients (
  id text PRIMARY KEY,                    -- cid_wa_491510416555
  phone text,                             -- –î–ª—è –ø–æ–∏—Å–∫–∞ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
  email text,
  full_name text NOT NULL,
  status text DEFAULT 'active' CHECK (status IN ('active', 'inactive', 'blocked')),
  category text,                          -- existing_client, new_client, unknown
  subcategory text,                       -- house_1, complex_a, ad_google, etc.
  source text,                            -- qr_code, advertisement, website, referral
  first_contact_at timestamptz DEFAULT now(),
  last_activity_at timestamptz DEFAULT now(),
  meta_data jsonb DEFAULT '{}'::jsonb,    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_clients_phone ON clients(phone);
CREATE INDEX idx_clients_category ON clients(category);
CREATE INDEX idx_clients_status ON clients(status);
```

### –¢–∞–±–ª–∏—Ü–∞: masters
```sql
CREATE TABLE masters (
  id text PRIMARY KEY,                    -- mid_wa_491510416555
  phone text,
  email text,
  full_name text NOT NULL,
  status text DEFAULT 'pending_approval' CHECK (status IN ('pending_approval', 'approved', 'active', 'suspended', 'blocked')),
  rating numeric(3,2) DEFAULT 0 CHECK (rating >= 0 AND rating <= 5),
  completed_jobs integer DEFAULT 0,
  specializations text[],                -- ['elektrik', 'sanit√§r', 'maler']
  working_hours jsonb,                   -- {"start": "08:00", "end": "18:00"}
  working_days text[],                   -- ['mo', 'di', 'mi', 'do', 'fr']
  service_area text,                     -- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–æ–Ω—ã
  has_vehicle boolean DEFAULT false,
  experience_years integer,
  qualifications text,
  documents_verified boolean DEFAULT false,
  approval_date timestamptz,
  admin_comment text,
  last_activity_at timestamptz DEFAULT now(),
  meta_data jsonb DEFAULT '{}'::jsonb,
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_masters_phone ON masters(phone);
CREATE INDEX idx_masters_status ON masters(status);
CREATE INDEX idx_masters_rating ON masters(rating);
CREATE INDEX idx_masters_specializations ON masters USING gin(specializations);
```

### –¢–∞–±–ª–∏—Ü–∞: user_links (—Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ñ–∏–ª—è–º–∏)
```sql
CREATE TABLE user_links (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id text REFERENCES clients(id) ON DELETE CASCADE,
  master_id text REFERENCES masters(id) ON DELETE CASCADE,
  link_type text DEFAULT 'same_person' CHECK (link_type IN ('same_person', 'family_member', 'company_employee', 'related')),
  confidence numeric(3,2) DEFAULT 1.0 CHECK (confidence >= 0 AND confidence <= 1.0),
  linked_by text,                        -- –°–∏—Å—Ç–µ–º–∞, –∞–¥–º–∏–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  linked_at timestamptz DEFAULT now(),
  notes text,                            -- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–≤—è–∑–∏
  UNIQUE(client_id, master_id)
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_user_links_client ON user_links(client_id);
CREATE INDEX idx_user_links_master ON user_links(master_id);
CREATE INDEX idx_user_links_confidence ON user_links(confidence);
```

### –¢–∞–±–ª–∏—Ü–∞: admin_users (—Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å)
```sql
CREATE TABLE admin_users (
  id text PRIMARY KEY,                    -- aid_web_admin_at_company_dot_com
  email text UNIQUE NOT NULL,
  full_name text NOT NULL,
  role text DEFAULT 'admin' CHECK (role IN ('admin', 'manager', 'support')),
  permissions jsonb DEFAULT '{}'::jsonb,
  last_login_at timestamptz,
  created_at timestamptz DEFAULT now()
);
```

---

## üîÑ –õ–æ–≥–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø
1. **–í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** ‚Üí –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
2. **–ü–æ–∏—Å–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π** ‚Üí –í–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö (clients, masters, admin_users)
3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** ‚Üí –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
4. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** ‚Üí –í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π workflow

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
```javascript
function determineActiveProfile(phone, channel, message) {
  // 1. –ò—â–µ–º –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
  const clientProfiles = findClientsByPhone(phone);
  const masterProfiles = findMastersByPhone(phone);

  // 2. –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –º–∞—Å—Ç–µ—Ä - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –µ–º—É
  const activeMaster = masterProfiles.find(m => m.status === 'active');
  if (activeMaster) {
    return { type: 'master', profile: activeMaster };
  }

  // 3. –ò–Ω–∞—á–µ –∏—â–µ–º –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
  const activeClient = clientProfiles.find(c => c.status === 'active');
  if (activeClient) {
    return { type: 'client', profile: activeClient };
  }

  // 4. –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –Ω–µ—Ç - –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
  if (clientProfiles.length === 0 && masterProfiles.length === 0) {
    return { type: 'new_contact', profile: null };
  }

  // 5. –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏, –Ω–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ - —Å–ø—Ä–æ—Å–∏—Ç—å —É—Ç–æ—á–Ω–µ–Ω–∏–µ
  return { type: 'clarification_needed', profiles: { clients: clientProfiles, masters: masterProfiles } };
}
```

### –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç —Å QR-–∫–æ–¥–∞
```
–í—Ö–æ–¥—è—â–µ–µ: "house_1_request" –æ—Ç +491510416555
–î–µ–π—Å—Ç–≤–∏–µ: –°–æ–∑–¥–∞—Ç—å cid_wa_491510416555, category="existing_client"
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –¥–æ–º–∞ ‚Ññ1
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–∞—Å—Ç–µ—Ä –ø–∏—à–µ—Ç –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è
```
–í—Ö–æ–¥—è—â–µ–µ: "–ì–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å" –æ—Ç +491510416555
–î–µ–π—Å—Ç–≤–∏–µ: –ù–∞–π–¥–µ–Ω mid_wa_491510416555 —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'active'
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ –º–∞—Å—Ç–µ—Ä
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ - –∏ –∫–ª–∏–µ–Ω—Ç –∏ –º–∞—Å—Ç–µ—Ä
```
–í—Ö–æ–¥—è—â–µ–µ: "–ù—É–∂–µ–Ω —Ä–µ–º–æ–Ω—Ç" –æ—Ç +491510416555
–î–µ–π—Å—Ç–≤–∏–µ: –ù–∞–π–¥–µ–Ω—ã –æ–±–∞ –ø—Ä–æ—Ñ–∏–ª—è, –º–∞—Å—Ç–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω
–†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ –º–∞—Å—Ç–µ—Ä (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
```
–í—Ö–æ–¥—è—â–µ–µ: "–ü—Ä–∏–≤–µ—Ç" –æ—Ç +491510416555
–î–µ–π—Å—Ç–≤–∏–µ: –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –º–∞—Å—Ç–µ—Ä–∞ (–æ–±–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã)
–†–µ–∑—É–ª—å—Ç–∞—Ç: –ó–∞–ø—Ä–æ—Å —É—Ç–æ—á–Ω–µ–Ω–∏—è "–í—ã –ø–∏—à–µ—Ç–µ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –∏–ª–∏ –º–∞—Å—Ç–µ—Ä?"
```

---

## üîó –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑—è–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ
```sql
-- –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç —Å —Ç–∞–∫–∏–º –∂–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
INSERT INTO user_links (client_id, master_id, link_type, confidence, linked_by)
SELECT
  c.id, $new_master_id, 'same_person', 0.9, 'system'
FROM clients c
WHERE c.phone = $phone AND c.status = 'active';
```

### –†—É—á–Ω–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (–∞–¥–º–∏–Ω)
- –í –∞–¥–º–∏–Ω–∫–µ: –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π
- Confidence score: 1.0 = —Ç–æ—á–Ω–æ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫, 0.5 = –≤–µ—Ä–æ—è—Ç–Ω–æ
- –¢–∏–ø—ã —Å–≤—è–∑–µ–π: same_person, family_member, company_employee

### –†–∞–∑—Ä—ã–≤ —Å–≤—è–∑–µ–π
- –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø—Ä–æ—Ñ–∏–ª—è
- –ü–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏

---

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º
```sql
-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT
  'clients' as type, COUNT(*) as count, AVG(EXTRACT(EPOCH FROM (now() - created_at))/86400) as avg_age_days
FROM clients
UNION ALL
SELECT
  'masters' as type, COUNT(*) as count, AVG(EXTRACT(EPOCH FROM (now() - created_at))/86400) as avg_age_days
FROM masters
UNION ALL
SELECT
  'links' as type, COUNT(*) as count, AVG(confidence) as avg_confidence
FROM user_links;
```

### –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∫–ª–∏–µ–Ω—Ç ‚Üí –º–∞—Å—Ç–µ—Ä
```sql
SELECT
  COUNT(DISTINCT ul.client_id) as converted_clients,
  COUNT(DISTINCT c.id) as total_clients,
  ROUND(COUNT(DISTINCT ul.client_id)::numeric / COUNT(DISTINCT c.id) * 100, 2) as conversion_rate
FROM clients c
LEFT JOIN user_links ul ON c.id = ul.client_id;
```

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (users)
```sql
users {
  id uuid,
  role text,  -- 'client' | 'master'
  phone text,
  email text,
  full_name text,
  status text,
  meta_data jsonb
}
```

### –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏
```sql
-- –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
-- (clients, masters, user_links, admin_users)

-- –®–∞–≥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
INSERT INTO clients (
  id, phone, email, full_name, status, category, meta_data, created_at
)
SELECT
  CONCAT('cid_wa_', REPLACE(REPLACE(phone, '+', ''), ' ', '')),
  phone, email, full_name, status,
  meta_data->>'client_category',
  meta_data,
  created_at
FROM users WHERE role = 'client';

-- –®–∞–≥ 3: –ú–∏–≥—Ä–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤
INSERT INTO masters (
  id, phone, email, full_name, status, meta_data, created_at
)
SELECT
  CONCAT('mid_wa_', REPLACE(REPLACE(phone, '+', ''), ' ', '')),
  phone, email, full_name, status, meta_data, created_at
FROM users WHERE role = 'master';

-- –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –¥–≤–æ–π–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏
-- (–ø–æ–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏–º, —Å–æ–∑–¥–∞–¥–∏–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç)

-- –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
-- (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º)

-- –®–∞–≥ 6: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
-- (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö workflow –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤)
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –µ—â–µ –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê**
- **–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ** (`users` —Ç–∞–±–ª–∏—Ü–∞)
- **–ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- **–í—Å–µ workflow –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å**

### –†–∏—Å–∫–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤:** –ù—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –ò–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, email –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è—Ö
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ JOIN –¥–ª—è —Å–≤—è–∑–µ–π

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:** –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∏ –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–¥–µ–ª–µ–Ω—ã
- **–ì–∏–±–∫–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã –∏ —Ä–æ–ª–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –†–∞–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é/–º–∞—Å—Ç–µ—Ä—Å–∫—É—é —á–∞—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –ß–µ—Ç–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–∏—Ö workflow** - –æ—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è
2. **–ü—Ä–æ—Ç–æ—Ç–∏–ø –º–∏–≥—Ä–∞—Ü–∏–∏** - —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–µ–Ω–æ—Å —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** - –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
4. **–ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è** - –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
5. **–†–∏—Å–∫–∏ –∏ –æ—Ç–∫–∞—Ç** - –ø–ª–∞–Ω –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

---

## ‚ùì –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **–û–±—ä–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏:** –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏?
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã?
3. **–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è:** –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞?
4. **–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞?

**–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –±–∞–∑—É –¥–ª—è —Ä–æ—Å—Ç–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.**
